(this["webpackJsonpreact-project"]=this["webpackJsonpreact-project"]||[]).push([[5],{8:function(e,t,n){"use strict";t.a=""},99:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(24),r=n.n(c),o=n(46),i=n(6),s=n(4),u=n(18),l=n(38),d=n(13),b=n(3),j=Object(u.c)({groupReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{rooms:[],latest:[],exist:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_group":return t.payload;case"add_my_group":return Object(b.a)(Object(b.a)({},e),{},{rooms:[].concat(Object(d.a)(e.rooms),[t.payload]),latest:[].concat(Object(d.a)(e.latest),[t.payload])});case"add_latest_group":return e.latest.includes(t.payload)?e:Object(b.a)(Object(b.a)({},e),{},{latest:[].concat(Object(d.a)(e.latest),[t.payload])});case"exit_group":return Object(b.a)(Object(b.a)({},e),{},{latest:e.latest.filter((function(e){return e!=t.payload}))});case"edit_group":return Object(b.a)(Object(b.a)({},e),{},{exist:!1});case"delete_my_group":return Object(b.a)(Object(b.a)({},e),{},{rooms:e.rooms.filter((function(e){return e!=t.payload})),latest:e.latest.filter((function(e){return e!=t.payload}))});case"clear":return{rooms:[],latest:[],exist:!1};default:return e}},chatReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=JSON.parse(JSON.stringify(e));switch(t.type){case"load_chat":return n[t.payload.room]?n[t.payload.room]=[].concat(Object(d.a)(t.payload.msgs),Object(d.a)(n[t.payload.room])):n[t.payload.room]=t.payload.msgs,n;case"add_chat":return n[t.payload.room]?n[t.payload.room]=[].concat(Object(d.a)(n[t.payload.room]),[t.payload.msg]):n[t.payload.room]=[t.payload.msg],n;case"delete_chat":return delete n[t.payload],n;case"clear":return{};default:return e}},userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:null,email:null,path:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_user":return t.payload;case"clear":return{name:null,email:null,path:null};default:return e}},friendReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pendings:[],friends:[],sent:[],exist:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_friend":return t.payload;case"set_friend":var n=t.payload.profile,a=t.payload.option;return"Accept"==a?Object(b.a)(Object(b.a)({},e),{},{pendings:e.pendings.filter((function(e){return e.email!=n.email})),friends:e.friends.concat(n)}):"Disconnect"==a||"Cancel request"==a?Object(b.a)(Object(b.a)({},e),{},{sent:e.sent.filter((function(e){return e.email!=n.email})),pendings:e.pendings.filter((function(e){return e.email!=n.email})),friends:e.friends.filter((function(e){return e.email!=n.email}))}):Object(b.a)(Object(b.a)({},e),{},{sent:e.sent.concat(n)});case"clear":return{pendings:[],friends:[],sent:[],exist:!1};default:return e}},profileReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_profile":return t.payload;case"clear":return{};default:return e}},startReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{exist:0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"start":return{exist:t.payload};case"end":case"clear":return{exist:0};default:return e}},postReducer:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{exist:!1,post:[]},a=arguments.length>1?arguments[1]:void 0,c=Object(d.a)(n.post);switch(a.type){case"load_post":return{exist:!0,post:a.payload.reverse()};case"add_post":return Object(b.a)(Object(b.a)({},n),{},{post:[a.payload].concat(Object(d.a)(n.post))});case"like_post":for(var r=0;r<c.length;r++)c[r]._id==a.payload._id&&(a.payload.liked?(c[r].likeCount--,c[r].liked=!1):(c[r].likeCount++,c[r].liked=!0));return Object(b.a)(Object(b.a)({},n),{},{post:c});case"hide_post":return Object(b.a)(Object(b.a)({},n),{},{post:n.post.filter((function(e){return e._id!=a.payload}))});case"add_comment":return e=c.find((function(e){return e._id===a.payload._id})).comment,e=[a.payload.comment].concat(Object(d.a)(e)),c.find((function(e){return e._id===a.payload._id})).comment=e,Object(b.a)(Object(b.a)({},n),{},{post:c});case"add_reply":return t=c.find((function(e){return e._id===a.payload._id})).comment[a.payload.index].reply,t=[a.payload.comment].concat(Object(d.a)(t)),c.find((function(e){return e._id===a.payload._id})).comment[a.payload.index].reply=t,Object(b.a)(Object(b.a)({},n),{},{post:c});case"edit_comment":return c.find((function(e){return e._id===a.payload._id})).comment[a.payload.index1]=a.payload.commentData,Object(b.a)(Object(b.a)({},n),{},{post:c});case"edit_reply":return c.find((function(e){return e._id===a.payload._id})).comment[a.payload.index].reply[a.payload.index1]=a.payload.commentData,Object(b.a)(Object(b.a)({},n),{},{post:c});case"delete_comment":return c.find((function(e){return e._id===a.payload._id})).comment.splice(a.payload.index1,1),Object(b.a)(Object(b.a)({},n),{},{post:c});case"delete_reply":return c.find((function(e){return e._id===a.payload._id})).comment[a.payload.index].reply.splice(a.payload.index1,1),Object(b.a)(Object(b.a)({},n),{},{post:c});case"clear":return{exist:!1,post:[]};default:return n}},recentReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{exist:0,chats:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_recent":return{exist:1,chats:t.payload};case"add_recent":return{exist:1,chats:[t.payload].concat(Object(d.a)(e.chats.filter((function(e){return e.roomName!=t.payload.roomName}))))};case"clear":return{exist:0,chats:[]};default:return e}}}),p=Object(u.d)(j,[],Object(u.a)(l.a)),f=n(5),O=n(9),m=n.n(O),h=n(8),y=n(113),g=n(115),x=n(2),v=Object(y.a)((function(e){return{root:{marginTop:"50vh"}}}));function _(){var e=v();return Object(x.jsx)("div",{className:e.root,children:Object(x.jsxs)("center",{children:[Object(x.jsx)(g.a,{}),Object(x.jsx)("div",{children:"Loading...Please wait"})]})})}function R(e,t){return function(n){var c=Object(a.useState)(0),r=Object(f.a)(c,2),o=r[0],i=r[1],u=Object(s.c)((function(e){return e.startReducer.exist})),l=Object(s.b)();return Object(a.useEffect)((function(){if(u)i(1);else{var e=localStorage.getItem("token");m.a.create({baseURL:h.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((function(e){e.data;l({type:"start",exist:1}),i(1)})).catch((function(e){i(2)}))}}),[]),0==o?Object(x.jsx)(_,{}):1==o?Object(x.jsx)(e,Object(b.a)({},n)):Object(x.jsx)(t,{redirect:"signin"})}}var S,z,k=Object(a.lazy)((function(){return n.e(23).then(n.bind(null,346))})),P=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(9)]).then(n.bind(null,377))})),w=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(10)]).then(n.bind(null,362))})),A=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(12)]).then(n.bind(null,376))})),E=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(2),n.e(4),n.e(11),n.e(17)]).then(n.bind(null,298))})),I=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(8)]).then(n.bind(null,363))})),L=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(18)]).then(n.bind(null,364))})),U=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(19)]).then(n.bind(null,365))})),N=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(15),n.e(22)]).then(n.bind(null,366))})),J=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(16),n.e(21)]).then(n.bind(null,367))})),C=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(20),n.e(24)]).then(n.bind(null,368))})),D=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(13)]).then(n.bind(null,372))})),q=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(14)]).then(n.bind(null,369))}));r.a.render(Object(x.jsx)(s.a,{store:p,children:Object(x.jsx)(a.Suspense,{fallback:Object(x.jsx)(_,{}),children:Object(x.jsx)(o.a,{children:Object(x.jsxs)(i.d,{children:[Object(x.jsx)(i.b,{exact:!0,path:"/",component:(S=D,z=k,function(e){var t=Object(a.useState)(0),n=Object(f.a)(t,2),c=n[0],r=n[1],o=Object(s.c)((function(e){return e.userReducer.email})),i=Object(s.b)();return Object(a.useEffect)((function(){if(o)r(1);else{var e=localStorage.getItem("token");m.a.create({baseURL:h.a,headers:{Authorization:"bearer ".concat(e)}}).get("getUser").then((function(e){var t=e.data;i({type:"start",payload:1}),i({type:"load_user",payload:{name:t.name,email:t.email,path:t.path}}),r(1)})).catch((function(e){r(2)}))}}),[]),0==c?Object(x.jsx)(_,{}):1==c?Object(x.jsx)(S,Object(b.a)({},e)):Object(x.jsx)(z,{redirect:"signin"})})}),Object(x.jsx)(i.b,{path:"/chats",component:R(w,k)}),Object(x.jsx)(i.b,{path:"/groups",component:R(P,k)}),Object(x.jsx)(i.b,{path:"/enterroom",component:function(e,t){return function(n){var c=Object(a.useState)(0),r=Object(f.a)(c,2),o=r[0],i=r[1],u=Object(s.c)((function(e){return e.groupReducer.exist}));return Object(a.useEffect)((function(){if(u)i(1);else{var e=localStorage.getItem("token");m.a.create({baseURL:h.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((function(e){e.data;i(1)})).catch((function(e){i(2)}))}})),0==o?Object(x.jsx)(_,{}):1==o?Object(x.jsx)(e,Object(b.a)({},n)):Object(x.jsx)(t,{redirect:"signin"})}}(J,k)}),Object(x.jsx)(i.b,{path:"/newroom",component:function(e,t){return function(n){var c=Object(a.useState)(0),r=Object(f.a)(c,2),o=r[0],i=r[1],u=Object(s.c)((function(e){return e.groupReducer.exist}));return Object(a.useEffect)((function(){if(u)i(1);else{var e=localStorage.getItem("token");m.a.create({baseURL:h.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((function(e){e.data;i(1)})).catch((function(e){i(2)}))}}),[]),0==o?Object(x.jsx)(_,{}):1==o?Object(x.jsx)(e,Object(b.a)({},n)):Object(x.jsx)(t,{redirect:"signin"})}}(N,k)}),Object(x.jsx)(i.b,{path:"/profile/:profile",component:function(e,t){return function(n){var c=Object(a.useState)(0),r=Object(f.a)(c,2),o=r[0],i=r[1],u=Object(a.useState)("signin"),l=Object(f.a)(u,2),d=l[0],j=l[1],p=Object(s.b)(),O=(Object(s.c)((function(e){return e.groupReducer.exist})),n.match.params.profile.split("-")),y=Object(f.a)(O,2),g=y[0];y[1];return Object(a.useEffect)((function(){var e=localStorage.getItem("token");m.a.create({baseURL:h.a,headers:{Authorization:"bearer ".concat(e)}}).post("getProfile",{email:g}).then((function(e){var t=e.data;1==t.status?(p({type:"load_profile",payload:{name:t.name,email:t.email,path:t.path}}),i(1)):(i(2),j(""))})).catch((function(e){i(2)}))}),[]),0==o?Object(x.jsx)(_,{}):1==o?Object(x.jsx)(e,Object(b.a)({},n)):Object(x.jsx)(t,{redirect:d})}}(E,k)}),Object(x.jsx)(i.b,{path:"/friends",component:function(e,t){return function(n){var c=Object(a.useState)(0),r=Object(f.a)(c,2),o=r[0],i=r[1],u=Object(s.c)((function(e){return e.startReducer.exist})),l=Object(s.b)();return Object(a.useEffect)((function(){if(u)i(1);else{var e=localStorage.getItem("token");m.a.create({baseURL:h.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((function(e){e.data;l({type:"start",payload:1}),i(1)})).catch((function(e){i(2)}))}}),[]),0==o?Object(x.jsx)(_,{}):1==o?Object(x.jsx)(e,Object(b.a)({},n)):Object(x.jsx)(t,{redirect:"signin"})}}(I,k)}),Object(x.jsx)(i.b,{exact:!0,path:"/chat/:room",component:function(e,t){return function(n){var c=Object(a.useState)(0),r=Object(f.a)(c,2),o=r[0],i=r[1],u=Object(a.useState)("signin"),l=Object(f.a)(u,2),d=l[0],j=l[1],p=n.match.params.room,O=Object(s.c)((function(e){return e.groupReducer.exist})),y=Object(s.c)((function(e){return e.groupReducer.latest}));return Object(a.useEffect)((function(){if(O)y.includes(p)?i(1):(j("enterroom"),i(2));else{var e=localStorage.getItem("token");m.a.create({baseURL:h.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((function(e){e.data.latest.includes(p)?i(1):(j("enterroom"),i(2))})).catch((function(e){i(2)}))}}),[]),0==o?Object(x.jsx)(_,{}):1==o?Object(x.jsx)(e,Object(b.a)({roomName:p},n)):Object(x.jsx)(t,{redirect:d})}}(A,k)}),Object(x.jsx)(i.b,{exact:!0,path:"/personal/:room/:emails",component:function(e,t){var n="",c="";return function(r){var o=Object(a.useState)(0),i=Object(f.a)(o,2),u=i[0],l=i[1],d=Object(a.useState)("signin"),j=Object(f.a)(d,2),p=j[0],O=j[1],y=r.match.params.emails.split("-"),g=Object(f.a)(y,2),v=g[0],R=(g[1],Object(s.b)()),S=Object(s.c)((function(e){return e.friendReducer.exist})),z=Object(s.c)((function(e){return e.friendReducer.friends}));return Object(a.useEffect)((function(){if(S){var e,t;n=null===(e=z.find((function(e){return e.email==v})))||void 0===e?void 0:e.name,c=null===(t=z.find((function(e){return e.email==v})))||void 0===t?void 0:t.path,n?l(1):(O(""),l(2))}else{var a=localStorage.getItem("token");m.a.create({baseURL:h.a,headers:{Authorization:"bearer ".concat(a)}}).get("getFriend").then((function(e){var t,a,r=e.data;R({type:"load_friend",payload:{friends:r.friends,pendings:r.pendings,sent:r.sent,exist:!0}}),n=null===(t=r.friends.find((function(e){return e.email==v})))||void 0===t?void 0:t.name,c=null===(a=r.friends.find((function(e){return e.email==v})))||void 0===a?void 0:a.path,n?l(1):(O(""),l(2))})).catch((function(e){l(2)}))}}),[]),0==u?Object(x.jsx)(_,{}):1==u?Object(x.jsx)(e,Object(b.a)({roomName:n,dp:c},r)):Object(x.jsx)(t,{redirect:p})}}(A,k)}),Object(x.jsx)(i.b,{path:"/signin",component:L}),Object(x.jsx)(i.b,{path:"/signup",component:U}),Object(x.jsx)(i.b,{path:"/changePassword",component:C}),Object(x.jsx)(i.b,{path:"/uploadpost",component:q})]})})})}),document.getElementById("root"))}},[[99,6,7]]]);
//# sourceMappingURL=main.e5a496ea.chunk.js.map