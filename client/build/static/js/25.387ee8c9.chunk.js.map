{"version":3,"sources":["components/uploadpost.js"],"names":["Copyright","variant","color","align","href","Date","getFullYear","toast","configure","useStyles","makeStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","palette","secondary","main","tabLink","justifyContent","form","width","submit","Uploadpost","props","classes","uploaderName","useSelector","state","userReducer","name","uploaderEmail","email","useState","desc","setDesc","dispatch","useDispatch","token","localStorage","getItem","secureAxios","axios","create","baseURL","url","headers","days","event","a","preventDefault","dateObj","day","getUTCDate","month","getUTCMonth","year","getUTCFullYear","h","getHours","m","getMinutes","time","getTime","parseInt","date","file","document","getElementById","files","data","FormData","append","post","then","response","body","status","value","success","msg","autoClose","type","payload","liked","likeCount","history","replace","error","catch","err","component","maxWidth","className","noValidate","required","multiline","rows","fullWidth","label","onChange","evt","target","autoFocus","for","style","cursor","id","setAttribute","window","URL","createObjectURL","height","onClick","mt"],"mappings":"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","file":"static/js/25.387ee8c9.chunk.js","sourcesContent":["import React,{useState} from 'react';\r\nimport {useSelector,useDispatch} from 'react-redux';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport {Link} from 'react-router-dom';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Box from '@material-ui/core/Box';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport imageCompression from 'browser-image-compression';\r\n\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\nimport axios from 'axios'\r\nimport url from '../url'\r\nimport {toast} from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\ntoast.configure()\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {'Copyright Â© '}\r\n      <Link color=\"inherit\" href=\"https://material-ui.com/\">\r\n        Your Website\r\n      </Link>{' '}\r\n      {new Date().getFullYear()}\r\n      {'.'}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  tabLink : {\r\n    display:\"flex\",\r\n    alignItems:\"center\",\r\n    justifyContent:\"center\"\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(1),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n}));\r\n\r\nexport default function Uploadpost(props) {\r\n  const classes = useStyles();\r\n  const uploaderName=useSelector(state=>state.userReducer.name)\r\n  const uploaderEmail=useSelector(state=>state.userReducer.email)\r\n\r\n  const [desc,setDesc]=useState('')\r\n  const dispatch=useDispatch()\r\n  const token=localStorage.getItem('token')\r\n  const secureAxios=axios.create(\r\n                        {\r\n                         baseURL:url,\r\n                         headers:{\r\n                          \"Authorization\":`bearer ${token}`\r\n                        }\r\n                      })\r\n   const days=['January','February','March','April','May','June','July','August','September','October','November','December']\r\n\r\n   async function upload(event){\r\n    event.preventDefault();\r\n\r\n    const dateObj = new Date();\r\n    const day = dateObj.getUTCDate();\r\n    const month = dateObj.getUTCMonth(); //months from 1-12\r\n    const year = dateObj.getUTCFullYear();\r\n\r\n    let h=dateObj.getHours();\r\n    let m=dateObj.getMinutes();\r\n\r\n    const time=dateObj.getTime()/1000;\r\n\r\n    h=(parseInt(h/10)==0)?('0'+h):h;\r\n    m=(parseInt(m/10)==0)?('0'+m):m;\r\n\r\n    const date=`${days[month]} ${day}, ${year} ${h}:${m}`\r\n    const file=document.getElementById('file-input').files[0]\r\n\r\n          let data=new FormData()\r\n          data.append('uploaderName',uploaderName)\r\n          data.append('uploaderEmail',uploaderEmail)\r\n          data.append('desc',desc)\r\n          data.append('path',file?.name)\r\n          data.append('time',time)\r\n          data.append('date',date)\r\n          data.append('file',file)\r\n\r\n\r\n\r\n          secureAxios.post('uploadpost',data)\r\n          .then((response)=>{\r\n            const body=response.data\r\n\r\n            if(body.status==1){\r\n              if(file)file.value=\"\"\r\n              setDesc(\"\")\r\n              toast.success(body.msg,{autoClose:1000})\r\n              dispatch({type:'add_post',payload:{...body.post,liked:false,likeCount:0}})\r\n              props.history.replace('/');\r\n            }\r\n            else toast.error('Something went wrong',{autoClose:1000})\r\n          })\r\n          .catch(err=>toast.error('Something went wrong',{autoClose:1000}) );\r\n}\r\n\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Add Post\r\n        </Typography>\r\n        <form className={classes.form} noValidate>\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            multiline\r\n            rows={2}\r\n            fullWidth\r\n            type='text'\r\n            label=\"Add description\"\r\n            value={desc}\r\n            onChange={(evt)=>setDesc(evt.target.value)}\r\n            autoFocus\r\n          />\r\n          Add photo\r\n          <label for=\"file-input\">\r\n           <AttachFileIcon style={{color:'blue',width:'80px',cursor:'pointer'}}/>\r\n          </label>\r\n          <input id=\"file-input\" name='file' type=\"file\" style={{display:'none'}} onChange={(evt)=>{\r\n           document.getElementById('preview').setAttribute('src', window.URL.createObjectURL(evt.target.files[0]))\r\n           }}/>\r\n           <img id='preview' width='200px' height='200px'/>\r\n          <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            onClick={upload}\r\n            className={classes.submit}\r\n          >\r\n            Post\r\n          </Button>\r\n        </form>\r\n      </div>\r\n      <Box mt={8}>\r\n        <Copyright />\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n"],"sourceRoot":""}