(this["webpackJsonpreact-project"]=this["webpackJsonpreact-project"]||[]).push([[5],{8:function(e,t,n){"use strict";t.a=""},99:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(23),r=n.n(c),o=n(47),i=n(6),s=n(4),u=n(18),l=n(38),d=n(17),b=n(3),j=Object(u.c)({groupReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{rooms:[],latest:[],exist:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_group":return t.payload;case"add_my_group":return Object(b.a)(Object(b.a)({},e),{},{rooms:[].concat(Object(d.a)(e.rooms),[t.payload]),latest:[].concat(Object(d.a)(e.latest),[t.payload])});case"add_latest_group":return e.latest.includes(t.payload)?e:Object(b.a)(Object(b.a)({},e),{},{latest:[].concat(Object(d.a)(e.latest),[t.payload])});case"exit_group":return Object(b.a)(Object(b.a)({},e),{},{latest:e.latest.filter((function(e){return e!=t.payload}))});case"edit_group":return Object(b.a)(Object(b.a)({},e),{},{exist:!1});case"delete_my_group":return Object(b.a)(Object(b.a)({},e),{},{rooms:e.rooms.filter((function(e){return e!=t.payload})),latest:e.latest.filter((function(e){return e!=t.payload}))});case"clear":return{rooms:[],latest:[],exist:!1};default:return e}},chatReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=JSON.parse(JSON.stringify(e));switch(t.type){case"load_chat":return n[t.payload.room]?n[t.payload.room]=[].concat(Object(d.a)(t.payload.msgs),Object(d.a)(n[t.payload.room])):n[t.payload.room]=t.payload.msgs,n;case"add_chat":return n[t.payload.room]?n[t.payload.room]=[].concat(Object(d.a)(n[t.payload.room]),[t.payload.msg]):n[t.payload.room]=[t.payload.msg],n;case"clear":return{};default:return e}},userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:null,email:null,path:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_user":return t.payload;case"clear":return{name:null,email:null,path:null};default:return e}},friendReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pendings:[],friends:[],sent:[],exist:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_friend":return t.payload;case"set_friend":var n=t.payload.profile,a=t.payload.option;return"Accept"==a?Object(b.a)(Object(b.a)({},e),{},{pendings:e.pendings.filter((function(e){return e.email!=n.email})),friends:e.friends.concat(n)}):"Disconnect"==a||"Cancel request"==a?Object(b.a)(Object(b.a)({},e),{},{sent:e.sent.filter((function(e){return e.email!=n.email})),pendings:e.pendings.filter((function(e){return e.email!=n.email})),friends:e.friends.filter((function(e){return e.email!=n.email}))}):Object(b.a)(Object(b.a)({},e),{},{sent:e.sent.concat(n)});case"clear":return{pendings:[],friends:[],sent:[],exist:!1};default:return e}},profileReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_profile":return t.payload;case"clear":return{};default:return e}},startReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{exist:0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"start":return{exist:t.payload};case"end":case"clear":return{exist:0};default:return e}},postReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{exist:!1,post:[]},t=arguments.length>1?arguments[1]:void 0,n=JSON.parse(JSON.stringify(e.post));switch(t.type){case"load_post":return{exist:!0,post:t.payload.reverse()};case"add_post":return Object(b.a)(Object(b.a)({},e),{},{post:[t.payload].concat(Object(d.a)(e.post))});case"like_post":for(var a=0;a<n.length;a++)n[a]._id==t.payload._id&&(t.payload.liked?(n[a].likeCount--,n[a].liked=!1):(n[a].likeCount++,n[a].liked=!0));return Object(b.a)(Object(b.a)({},e),{},{post:n});case"hide_post":return Object(b.a)(Object(b.a)({},e),{},{post:e.post.filter((function(e){return e._id!=t.payload}))});case"clear":return{exist:!1,post:[]};default:return e}},recentReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{exist:0,chats:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"load_recent":return{exist:1,chats:t.payload};case"add_recent":return{exist:1,chats:[t.payload].concat(Object(d.a)(e.chats.filter((function(e){return e.roomName!=t.payload.roomName}))))};case"clear":return{exist:0,chats:[]};default:return e}}}),f=Object(u.d)(j,[],Object(u.a)(l.a)),p=n(5),O=n(9),h=n.n(O),m=n(8),g=n(113),x=n(115),y=n(2),v=Object(g.a)((function(e){return{root:{marginTop:"50vh"}}}));function R(){var e=v();return Object(y.jsx)("div",{className:e.root,children:Object(y.jsxs)("center",{children:[Object(y.jsx)(x.a,{}),Object(y.jsx)("div",{children:"Loading...Please wait"})]})})}function _(e,t){return function(n){var c=Object(a.useState)(0),r=Object(p.a)(c,2),o=r[0],i=r[1],u=Object(s.c)((function(e){return e.startReducer.exist})),l=Object(s.b)();return Object(a.useEffect)((function(){if(u)i(1);else{var e=localStorage.getItem("token");h.a.create({baseURL:m.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((function(e){e.data;l({type:"start",exist:1}),i(1)})).catch((function(e){i(2)}))}}),[]),0==o?Object(y.jsx)(R,{}):1==o?Object(y.jsx)(e,Object(b.a)({},n)):Object(y.jsx)(t,{redirect:"signin"})}}var S,z,k=Object(a.lazy)((function(){return n.e(22).then(n.bind(null,353))})),P=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(10)]).then(n.bind(null,378))})),w=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(11)]).then(n.bind(null,360))})),A=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(3),n.e(4),n.e(15)]).then(n.bind(null,379))})),E=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(3),n.e(12),n.e(18)]).then(n.bind(null,282))})),I=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(8)]).then(n.bind(null,361))})),L=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(19),n.e(24)]).then(n.bind(null,362))})),N=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(17),n.e(25)]).then(n.bind(null,363))})),U=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(14)]).then(n.bind(null,364))})),J=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(13)]).then(n.bind(null,365))})),C=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(20),n.e(23)]).then(n.bind(null,366))})),q=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(9),n.e(21)]).then(n.bind(null,367))})),B=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(16)]).then(n.bind(null,374))}));r.a.render(Object(y.jsx)(s.a,{store:f,children:Object(y.jsx)(a.Suspense,{fallback:Object(y.jsx)(R,{}),children:Object(y.jsx)(o.a,{children:Object(y.jsxs)(i.d,{children:[Object(y.jsx)(i.b,{exact:!0,path:"/",component:(S=q,z=k,function(e){var t=Object(a.useState)(0),n=Object(p.a)(t,2),c=n[0],r=n[1],o=Object(s.c)((function(e){return e.userReducer.email})),i=Object(s.b)();return Object(a.useEffect)((function(){if(o)r(1);else{var e=localStorage.getItem("token");h.a.create({baseURL:m.a,headers:{Authorization:"bearer ".concat(e)}}).get("getUser").then((function(e){var t=e.data;i({type:"start",payload:1}),i({type:"load_user",payload:{name:t.name,email:t.email,path:t.path}}),r(1)})).catch((function(e){r(2)}))}}),[]),0==c?Object(y.jsx)(R,{}):1==c?Object(y.jsx)(S,Object(b.a)({},e)):Object(y.jsx)(z,{redirect:"signin"})})}),Object(y.jsx)(i.b,{path:"/chats",component:_(w,k)}),Object(y.jsx)(i.b,{path:"/groups",component:_(P,k)}),Object(y.jsx)(i.b,{path:"/enterroom",component:function(e,t){return function(n){var c=Object(a.useState)(0),r=Object(p.a)(c,2),o=r[0],i=r[1],u=Object(s.c)((function(e){return e.groupReducer.exist}));return Object(a.useEffect)((function(){if(u)i(1);else{var e=localStorage.getItem("token");h.a.create({baseURL:m.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((function(e){e.data;i(1)})).catch((function(e){i(2)}))}})),0==o?Object(y.jsx)(R,{}):1==o?Object(y.jsx)(e,Object(b.a)({},n)):Object(y.jsx)(t,{redirect:"signin"})}}(J,k)}),Object(y.jsx)(i.b,{path:"/newroom",component:function(e,t){return function(n){var c=Object(a.useState)(0),r=Object(p.a)(c,2),o=r[0],i=r[1],u=Object(s.c)((function(e){return e.groupReducer.exist}));return Object(a.useEffect)((function(){if(u)i(1);else{var e=localStorage.getItem("token");h.a.create({baseURL:m.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((function(e){e.data;i(1)})).catch((function(e){i(2)}))}}),[]),0==o?Object(y.jsx)(R,{}):1==o?Object(y.jsx)(e,Object(b.a)({},n)):Object(y.jsx)(t,{redirect:"signin"})}}(U,k)}),Object(y.jsx)(i.b,{path:"/profile/:profile",component:function(e,t){return function(n){var c=Object(a.useState)(0),r=Object(p.a)(c,2),o=r[0],i=r[1],u=Object(s.b)(),l=(Object(s.c)((function(e){return e.groupReducer.exist})),n.match.params.profile.split("-")),d=Object(p.a)(l,2),j=d[0];d[1];return Object(a.useEffect)((function(){var e=localStorage.getItem("token");h.a.create({baseURL:m.a,headers:{Authorization:"bearer ".concat(e)}}).post("getProfile",{email:j}).then((function(e){var t=e.data;1==t.status?(u({type:"load_profile",payload:{name:t.name,email:t.email,path:t.path}}),i(1)):i(2)})).catch((function(e){i(2)}))}),[]),0==o?Object(y.jsx)(R,{}):1==o?Object(y.jsx)(e,Object(b.a)({},n)):Object(y.jsx)(t,{redirect:""})}}(E,k)}),Object(y.jsx)(i.b,{path:"/friends",component:function(e,t){return function(n){var c=Object(a.useState)(0),r=Object(p.a)(c,2),o=r[0],i=r[1],u=Object(s.c)((function(e){return e.startReducer.exist})),l=Object(s.b)();return Object(a.useEffect)((function(){if(u)i(1);else{var e=localStorage.getItem("token");h.a.create({baseURL:m.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((function(e){e.data;l({type:"start",payload:1}),i(1)})).catch((function(e){i(2)}))}}),[]),0==o?Object(y.jsx)(R,{}):1==o?Object(y.jsx)(e,Object(b.a)({},n)):Object(y.jsx)(t,{redirect:"signin"})}}(I,k)}),Object(y.jsx)(i.b,{exact:!0,path:"/chat/:room",component:function(e,t){return function(n){var c=Object(a.useState)(0),r=Object(p.a)(c,2),o=r[0],i=r[1],u=Object(a.useState)("signin"),l=Object(p.a)(u,2),d=l[0],j=l[1],f=n.match.params.room,O=Object(s.c)((function(e){return e.groupReducer.exist})),g=Object(s.c)((function(e){return e.groupReducer.latest}));return Object(a.useEffect)((function(){if(O)g.includes(f)?i(1):(j("enterroom"),i(2));else{var e=localStorage.getItem("token");h.a.create({baseURL:m.a,headers:{Authorization:"bearer ".concat(e)}}).get("getRooms").then((function(e){e.data.latest.includes(f)?i(1):(j("enterroom"),i(2))})).catch((function(e){i(2)}))}}),[]),0==o?Object(y.jsx)(R,{}):1==o?Object(y.jsx)(e,Object(b.a)({roomName:f},n)):Object(y.jsx)(t,{redirect:d})}}(A,k)}),Object(y.jsx)(i.b,{exact:!0,path:"/personal/:room/:emails",component:function(e,t){var n="",c="";return function(r){var o=Object(a.useState)(0),i=Object(p.a)(o,2),u=i[0],l=i[1],d=Object(a.useState)(""),j=Object(p.a)(d,2),f=j[0],O=j[1],g=r.match.params.emails.split("-"),x=Object(p.a)(g,2),v=x[0],_=(x[1],Object(s.b)()),S=Object(s.c)((function(e){return e.friendReducer.exist})),z=Object(s.c)((function(e){return e.friendReducer.friends}));return Object(a.useEffect)((function(){if(S){var e,t;n=null===(e=z.find((function(e){return e.email==v})))||void 0===e?void 0:e.name,c=null===(t=z.find((function(e){return e.email==v})))||void 0===t?void 0:t.path,n?l(1):(O(""),l(2))}else{var a=localStorage.getItem("token");h.a.create({baseURL:m.a,headers:{Authorization:"bearer ".concat(a)}}).get("getFriend").then((function(e){var t,a,r=e.data;_({type:"load_friend",payload:{friends:r.friends,pendings:r.pendings,sent:r.sent,exist:!0}}),n=null===(t=r.friends.find((function(e){return e.email==v})))||void 0===t?void 0:t.name,c=null===(a=r.friends.find((function(e){return e.email==v})))||void 0===a?void 0:a.path,n?l(1):(O(""),l(2))})).catch((function(e){l(2)}))}}),[]),0==u?Object(y.jsx)(R,{}):1==u?Object(y.jsx)(e,Object(b.a)({roomName:n,dp:c},r)):Object(y.jsx)(t,{redirect:f})}}(A,k)}),Object(y.jsx)(i.b,{path:"/signin",component:L}),Object(y.jsx)(i.b,{path:"/signup",component:N}),Object(y.jsx)(i.b,{path:"/changePassword",component:C}),Object(y.jsx)(i.b,{path:"/uploadpost",component:B})]})})})}),document.getElementById("root"))}},[[99,6,7]]]);
//# sourceMappingURL=main.d160ed85.chunk.js.map