{"version":3,"sources":["components/uploadpost.js"],"names":["Copyright","variant","color","align","href","Date","getFullYear","toast","configure","useStyles","makeStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","boxShadow","padding","avatar","margin","backgroundColor","palette","secondary","main","tabLink","justifyContent","form","width","submit","Uploadpost","props","classes","uploaderName","useSelector","state","userReducer","name","uploaderEmail","email","uploaderDp","path","useState","desc","setDesc","setLoader","dispatch","useDispatch","token","localStorage","getItem","secureAxios","axios","create","baseURL","url","headers","days","event","a","preventDefault","dateObj","day","getUTCDate","month","getUTCMonth","year","getUTCFullYear","h","getHours","m","getMinutes","time","getTime","parseInt","date","file","document","getElementById","files","type","includes","error","data","FormData","append","post","then","response","body","status","value","success","msg","autoClose","payload","liked","likeCount","history","replace","catch","err","component","maxWidth","elevation","className","noValidate","required","multiline","rows","fullWidth","label","onChange","evt","target","autoFocus","for","style","cursor","id","setAttribute","window","URL","createObjectURL","height","controls","onClick","container","item","xs","to","mt"],"mappings":"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","file":"static/js/25.ec6602b4.chunk.js","sourcesContent":["import React,{useState} from 'react';\r\nimport {useSelector,useDispatch} from 'react-redux';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport {Link} from 'react-router-dom';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Box from '@material-ui/core/Box';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport imageCompression from 'browser-image-compression';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport AddPhotoAlternateIcon from '@material-ui/icons/AddPhotoAlternate';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\nimport axios from 'axios'\r\nimport url from '../url'\r\nimport {toast} from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\ntoast.configure()\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {'Copyright Â© '}\r\n      <Link color=\"inherit\" href=\"https://material-ui.com/\">\r\n        Your Website\r\n      </Link>{' '}\r\n      {new Date().getFullYear()}\r\n      {'.'}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    boxShadow:'0px 0px 3px 3px blue',\r\n    padding:'30px'\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  tabLink : {\r\n    display:\"flex\",\r\n    alignItems:\"center\",\r\n    justifyContent:\"center\"\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(1),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n}));\r\n\r\nexport default function Uploadpost(props) {\r\n  const classes = useStyles();\r\n  const uploaderName=useSelector(state=>state.userReducer.name)\r\n  const uploaderEmail=useSelector(state=>state.userReducer.email)\r\n  const uploaderDp=useSelector(state=>state.userReducer.path)\r\n\r\n  const [desc,setDesc]=useState('')\r\n  const [loader,setLoader]=useState('none')\r\n\r\n  const dispatch=useDispatch()\r\n  const token=localStorage.getItem('token')\r\n  const secureAxios=axios.create(\r\n                        {\r\n                         baseURL:url,\r\n                         headers:{\r\n                          \"Authorization\":`bearer ${token}`\r\n                        }\r\n                      })\r\n   const days=['January','February','March','April','May','June','July','August','September','October','November','December']\r\n\r\n   async function upload(event){\r\n\r\n     setLoader('block')\r\n\r\n    event.preventDefault();\r\n\r\n    const dateObj = new Date();\r\n    const day = dateObj.getUTCDate();\r\n    const month = dateObj.getUTCMonth(); //months from 1-12\r\n    const year = dateObj.getUTCFullYear();\r\n\r\n    let h=dateObj.getHours();\r\n    let m=dateObj.getMinutes();\r\n\r\n    const time=dateObj.getTime()/1000;\r\n\r\n    h=(parseInt(h/10)==0)?('0'+h):h;\r\n    m=(parseInt(m/10)==0)?('0'+m):m;\r\n\r\n    const date=`${days[month]} ${day}, ${year} ${h}:${m}`\r\n    const file=document.getElementById('file-input').files[0]\r\n        if(file.type.includes('image') || file.type.includes('video')){}\r\n        else {toast.error('Only images and videos are allowed'); return false;}\r\n\r\n          let data=new FormData()\r\n          data.append('uploaderName',uploaderName)\r\n          data.append('uploaderEmail',uploaderEmail)\r\n          data.append('uploaderDp',uploaderDp)\r\n          data.append('desc',desc)\r\n          data.append('path',file?.name)\r\n          data.append('time',time)\r\n          data.append('date',date)\r\n          data.append('file',file)\r\n\r\n          secureAxios.post('uploadpost',data)\r\n          .then((response)=>{\r\n            setLoader('none')\r\n            const body=response.data\r\n\r\n            if(body.status==1){\r\n              if(file)file.value=\"\"\r\n              setDesc(\"\")\r\n              toast.success(body.msg,{autoClose:1000})\r\n              dispatch({type:'add_post',payload:{...body.post,liked:false,likeCount:0}})\r\n              props.history.replace('/');\r\n            }\r\n            else toast.error('Something went wrong',{autoClose:1000})\r\n          })\r\n          .catch(err=>{  setLoader('none'); toast.error('Something went wrong',{autoClose:1000}); });\r\n}\r\n\r\n\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <CssBaseline />\r\n      <Paper  elevation={3}  className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <AddPhotoAlternateIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Add Post\r\n        </Typography>\r\n        <form className={classes.form} noValidate>\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            multiline\r\n            rows={2}\r\n            fullWidth\r\n            type='text'\r\n            label=\"Add description\"\r\n            value={desc}\r\n            onChange={(evt)=>setDesc(evt.target.value)}\r\n            autoFocus\r\n          />\r\n          Add Photo\r\n          <label for=\"file-input\">\r\n           <AttachFileIcon style={{color:'blue',width:'80px',cursor:'pointer'}}/>\r\n          </label>\r\n          <input id=\"file-input\" name='file' type=\"file\" style={{display:'none'}} onChange={(evt)=>{\r\n            const type=evt.target.files[0].type;\r\n            const name=evt.target.files[0].type;\r\n            if(type.includes('image'))document.getElementById('previewI').setAttribute('src', window.URL.createObjectURL(evt.target.files[0]))\r\n            else {document.getElementById('previewV').style.display='block';document.getElementById('previewV').setAttribute('src', window.URL.createObjectURL(evt.target.files[0])); }\r\n           }}/>\r\n          <img id='previewI' width='100%' height='100%'/>\r\n          <video id='previewV' style={{display:'none'}} width=\"100%\" height=\"100%\" controls>\r\n              <source  type=\"video/mp4\" />\r\n              <source  type=\"video/ogg\" />\r\n          </video>\r\n          <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            onClick={upload}\r\n            className={classes.submit}\r\n          >\r\n            Post\r\n          </Button>\r\n          <Grid container>\r\n            <Grid item xs>\r\n              <Link to=\"/\" variant=\"body2\">\r\n                Back to Home\r\n              </Link>\r\n            </Grid>\r\n          </Grid>\r\n        </form>\r\n      </Paper>\r\n      <Box mt={8}>\r\n        <Copyright />\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n"],"sourceRoot":""}